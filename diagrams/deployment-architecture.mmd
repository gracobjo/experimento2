graph TB
    %% Usuarios
    User[ğŸ‘¤ Usuario Final]
    Admin[ğŸ‘¨â€ğŸ’¼ Administrador]
    Lawyer[ğŸ‘¨â€âš–ï¸ Abogado]
    Client[ğŸ‘¤ Cliente]

    %% Frontend (Vercel)
    subgraph "Frontend - Vercel"
        Frontend[ğŸŒ React App<br/>https://experimento2-fenm.vercel.app]
        FrontendComponents[ğŸ“¦ Componentes React]
        FrontendPages[ğŸ“„ PÃ¡ginas]
        FrontendState[ğŸ’¾ Estado Local]
    end

    %% Backend (Railway)
    subgraph "Backend - Railway"
        Backend[âš™ï¸ NestJS API<br/>https://experimento2-production.up.railway.app]
        AuthModule[ğŸ” Auth Module]
        InvoicesModule[ğŸ“„ Invoices Module]
        CasesModule[ğŸ“ Cases Module]
        ReportsModule[ğŸ“Š Reports Module]
        ParametrosModule[âš™ï¸ ParÃ¡metros Module]
        LayoutsModule[ğŸ¨ Layouts Module]
        UsersModule[ğŸ‘¥ Users Module]
        ChatModule[ğŸ’¬ Chat Module]
    end

    %% Chatbot (Railway)
    subgraph "Chatbot - Railway"
        Chatbot[ğŸ¤– Python FastAPI<br/>https://chatbot-legal-production.up.railway.app]
        NLPService[ğŸ§  NLP Service]
        IntentDetection[ğŸ¯ Intent Detection]
        EntityExtraction[ğŸ·ï¸ Entity Extraction]
        ResponseGeneration[ğŸ’­ Response Generation]
    end

    %% Base de Datos
    subgraph "Database - Railway"
        Database[(ğŸ—„ï¸ PostgreSQL<br/>Database)]
        PrismaORM[ğŸ”§ Prisma ORM]
    end

    %% Servicios Externos
    subgraph "External Services"
        Vercel[ğŸš€ Vercel<br/>Frontend Hosting]
        Railway[ğŸš‚ Railway<br/>Backend & Chatbot Hosting]
        Autofirma[ğŸ“ AutoFirma<br/>Digital Signatures]
        EmailService[ğŸ“§ Email Service]
    end

    %% Conexiones Frontend
    User --> Frontend
    Admin --> Frontend
    Lawyer --> Frontend
    Client --> Frontend

    %% Conexiones Backend
    Frontend --> Backend
    Backend --> Database
    Backend --> PrismaORM
    PrismaORM --> Database

    %% Conexiones Chatbot
    Frontend --> Chatbot
    Chatbot --> Backend
    Chatbot --> NLPService
    NLPService --> IntentDetection
    NLPService --> EntityExtraction
    NLPService --> ResponseGeneration

    %% Conexiones Servicios Externos
    Frontend -.-> Vercel
    Backend -.-> Railway
    Chatbot -.-> Railway
    Backend -.-> Autofirma
    Backend -.-> EmailService

    %% Estilos
    classDef frontend fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef backend fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef chatbot fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef database fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef external fill:#fce4ec,stroke:#880e4f,stroke-width:2px
    classDef user fill:#f1f8e9,stroke:#33691e,stroke-width:2px

    class Frontend,FrontendComponents,FrontendPages,FrontendState frontend
    class Backend,AuthModule,InvoicesModule,CasesModule,ReportsModule,ParametrosModule,LayoutsModule,UsersModule,ChatModule backend
    class Chatbot,NLPService,IntentDetection,EntityExtraction,ResponseGeneration chatbot
    class Database,PrismaORM database
    class Vercel,Railway,Autofirma,EmailService external
    class User,Admin,Lawyer,Client user 